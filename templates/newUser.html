{% extends "base.html" %}
{% block content %}
    <h1>EECS485 PROJECT 1</h1>
    <p class="center">
    New User
    </p>
    <ul>
        <div id="errors_mess"></div>
        <form>   
            Username: <input type ="text" name="username" id="new_username_input"><br/>
            First Name: <input type ="text" name="firstname" id="new_firstname_input"><br/>
            Last Name: <input type ="text" name="lastname" id="new_lastname_input"><br/>
            Password: <input type="password" name="password1" id="new_password1_input"><br/>
            Confirm Password: <input type="password" name="password2" id="new_password2_input"><br/>
            Email: <input type ="text" name="email" id="new_email_input"><br/>
            <button id="new_submit">Submit</button>
        </form>
        <script type="text/javascript">
            $('#new_submit').click( function(e) {
                e.preventDefault();
                $.ajax({
                    type: 'POST',
                    contentType: "application/json; charset=UTF-8",
                    data: JSON.stringify({'username': $("#new_username_input").val(),
                            'firstname': $("#new_firstname_input").val(),
                            'lastname': $("#new_lastname_input").val(),
                            'password1': $("#new_password1_input").val(),
                            'password2': $("#new_password2_input").val(),
                            'email': $("#new_email_input").val()}),
                    url: 'http://localhost:3000/p2gkisj6/p3/api/v1/user',
                    success: function(data) {
                        window.location.href = "http://localhost:3000/p2gkisj6/p3/login";
                    },
                    error: function(errors) {
                        str = JSON.stringify(errors);
                        console.log(JSON.parse(str).responseText);

                        
                        //str = JSON.parse(str);
                        //str = str.responseText;
                        //str = JSON.parse(str);
                        //message = str.message;
                        //console.log(message);
                        
                        for(error in errors){
                            $('#errors_mess').append('<div class="error">' + error.message + '</div>');
                        }
                    }
                });
            });
        </script>
    </ul>
{% endblock %}